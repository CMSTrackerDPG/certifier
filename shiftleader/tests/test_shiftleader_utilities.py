from decimal import Decimal

import pytest
from mixer.backend.django import mixer
from shiftleader.utilities.utilities import *

from unittest.mock import MagicMock
from runregistryapp.client import RunRegistryClient, TrackerRunRegistryClient
pytestmark = pytest.mark.django_db

class TestUtilities:
    def test_to_date(self):
        assert datetime.date(2010, 5, 17) == to_date(datetime.datetime(2010, 5, 17))
        assert datetime.date(2010, 5, 17) == to_date(datetime.date(2010, 5, 17))
        assert datetime.date(2010, 5, 17) == to_date("2010-05-17")

    def test_chunks(self):
        assert [range(10, 20), range(20, 29)] == list(chunks(range(10, 29), 10))

    def test_convert_run_registry_to_trackercertification(self):
        input=[{'class': 'Collisions17', 'state': 'SIGNOFF', 'short_run': 1, 'significant': True, 'stop_reason': None, 'run_number': 299327, 'name': '/ReReco/Run2017B_UL2019/DQM', 'dataset_attributes': {'dc_state': 'waiting dqm gui', 'dt_state': 'COMPLETED', 'cms_state': 'waiting dqm gui', 'csc_state': 'COMPLETED', 'hlt_state': 'COMPLETED', 'l1t_state': 'COMPLETED', 'rpc_state': 'COMPLETED', 'ecal_state': 'COMPLETED', 'hcal_state': 'COMPLETED', 'lumi_state': 'COMPLETED', 'muon_state': 'COMPLETED', 'egamma_state': 'COMPLETED', 'global_state': 'OPEN', 'jetmet_state': 'COMPLETED', 'tracker_state': 'COMPLETED'}, 'deleted': False, 'version': 4260755, 'lumisections': {'dt-dt': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'rpc-hv': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'rpc-lv': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'cms-cms': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'csc-csc': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'csc-mem': {'EMPTY': 0, 'NOTSET': 82, 'causes': ['UNDEF'], 'comments': []}, 'csc-mep': {'EMPTY': 0, 'NOTSET': 82, 'causes': ['UNDEF'], 'comments': []}, 'ecal-es': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'hcal-hb': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'hcal-he': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'hcal-hf': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'hlt-hlt': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'hlt-tau': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'l1t-jet': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'l1t-l1t': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'rpc-feb': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'rpc-rpc': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'tau-tau': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'csc-ddus': {'EMPTY': 0, 'NOTSET': 82, 'causes': ['UNDEF'], 'comments': []}, 'ecal-ebm': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'ecal-ebp': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'ecal-eem': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'ecal-eep': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'ecal-esm': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'ecal-esp': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'ecal-tpg': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'hcal-ho0': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'l1t-muon': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'rpc-elog': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': [' http://cmsonline.cern.ch/cms-elog/998994']}, 'btag-btag': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'csc-csctf': {'EMPTY': 0, 'NOTSET': 82, 'causes': ['UNDEF'], 'comments': []}, 'ecal-ecal': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'hcal-hbls': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'hcal-hcal': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'hcal-hels': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'hcal-hfls': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'hcal-ho12': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'hlt-bjets': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'hlt-muons': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'l1t-l1tmu': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'lumi-lumi': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'muon-muon': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'rpc-noise': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': [' https://cmswbm.web.cern.ch/cmswbm/cmsdb/servlet/RPCSummary?Run=299327&TopMenu=RPCRunSummary2&TopMenu2=ZeroPage&SubMenu=1']}, 'csc-strips': {'EMPTY': 0, 'NOTSET': 82, 'causes': ['UNDEF'], 'comments': []}, 'csc-timing': {'EMPTY': 0, 'NOTSET': 82, 'causes': ['UNDEF'], 'comments': []}, 'dc-lowlumi': {'BAD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'ecal-laser': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'ecal-noise': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'hcal-ho0ls': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'hlt-global': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'hlt-jetmet': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'ctpps-ctpps': {'BAD': 82, 'EMPTY': 0, 'causes': [], 'comments': []}, 'ecal-timing': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'hcal-ho12ls': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'hlt-photons': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'l1t-e_gamma': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'l1t-hf_tech': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'l1t-l1tcalo': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'l1t-muon_dt': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'csc-gasgains': {'EMPTY': 0, 'NOTSET': 82, 'causes': ['UNDEF'], 'comments': []}, 'csc-segments': {'EMPTY': 0, 'NOTSET': 82, 'causes': ['UNDEF'], 'comments': []}, 'l1t-bcs_tech': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'l1t-hf_rings': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'l1t-muon_csc': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'l1t-muon_rpc': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'l1t-rpc_tech': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'l1t-software': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'castor-castor': {'EMPTY': 0, 'causes': ['UNDEF'], 'EXCLUDED': 82, 'comments': []}, 'csc-integrity': {'EMPTY': 0, 'NOTSET': 82, 'causes': ['UNDEF'], 'comments': []}, 'csc-occupancy': {'EMPTY': 0, 'NOTSET': 82, 'causes': ['UNDEF'], 'comments': []}, 'csc-pedestals': {'EMPTY': 0, 'NOTSET': 82, 'causes': ['UNDEF'], 'comments': []}, 'csc-triggerpe': {'EMPTY': 0, 'NOTSET': 82, 'causes': ['UNDEF'], 'comments': []}, 'dt-dt_private': {'BAD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'ecal-analysis': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'egamma-egamma': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'hlt-electrons': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'hlt-technical': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'jetmet-jetmet': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'l1t-bptx_tech': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'tracker-pixel': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'tracker-strip': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'tracker-track': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'csc-efficiency': {'EMPTY': 0, 'NOTSET': 82, 'causes': ['UNDEF'], 'comments': []}, 'csc-resolution': {'EMPTY': 0, 'NOTSET': 82, 'causes': ['UNDEF'], 'comments': []}, 'ctpps-rp45_210': {'EMPTY': 0, 'NOTSET': 82, 'causes': [], 'comments': []}, 'ctpps-rp45_220': {'EMPTY': 0, 'NOTSET': 82, 'causes': [], 'comments': []}, 'ctpps-rp45_cyl': {'EMPTY': 0, 'NOTSET': 82, 'causes': [], 'comments': []}, 'ctpps-rp56_210': {'EMPTY': 0, 'NOTSET': 82, 'causes': [], 'comments': []}, 'ctpps-rp56_220': {'EMPTY': 0, 'NOTSET': 82, 'causes': [], 'comments': []}, 'ctpps-rp56_cyl': {'EMPTY': 0, 'NOTSET': 82, 'causes': [], 'comments': []}, 'ecal-preshower': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'csc-csc_private': {'BAD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'ecal-collisions': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'ecal-es_private': {'BAD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'hlt-hlt_private': {'BAD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'l1t-energy_sums': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'rpc-rpc_private': {'BAD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'tau-tau_private': {'EMPTY': 0, 'NOTSET': 82, 'causes': [], 'comments': []}, 'btag-btag_private': {'EMPTY': 0, 'NOTSET': 82, 'causes': [], 'comments': []}, 'ecal-ecal_private': {'BAD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'hcal-hcal_private': {'BAD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'lumi-lumi_private': {'BAD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'muon-muon_private': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'castor-castor_private': {'EMPTY': 0, 'NOTSET': 82, 'causes': [], 'comments': []}, 'egamma-egamma_private': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'jetmet-jetmet_private': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'tracker-pixel_private': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'tracker-strip_private': {'BAD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'tracker-track_private': {'BAD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}}}]


        ret = convert_run_registry_to_trackercertification(input)

        print(ret)

        assert [{'state': 'SIGNOFF', 'short_run': 1, 'significant': True, 'stop_reason': None, 'dataset_attributes': {'dc_state': 'waiting dqm gui', 'dt_state': 'COMPLETED', 'cms_state': 'waiting dqm gui', 'csc_state': 'COMPLETED', 'hlt_state': 'COMPLETED', 'l1t_state': 'COMPLETED', 'rpc_state': 'COMPLETED', 'ecal_state': 'COMPLETED', 'hcal_state': 'COMPLETED', 'lumi_state': 'COMPLETED', 'muon_state': 'COMPLETED', 'egamma_state': 'COMPLETED', 'global_state': 'OPEN', 'jetmet_state': 'COMPLETED', 'tracker_state': 'COMPLETED'}, 'deleted': False, 'version': 4260755, 'lumisections': {'dt-dt': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'rpc-hv': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'rpc-lv': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'cms-cms': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'csc-csc': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'csc-mem': {'EMPTY': 0, 'NOTSET': 82, 'causes': ['UNDEF'], 'comments': []}, 'csc-mep': {'EMPTY': 0, 'NOTSET': 82, 'causes': ['UNDEF'], 'comments': []}, 'ecal-es': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'hcal-hb': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'hcal-he': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'hcal-hf': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'hlt-hlt': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'hlt-tau': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'l1t-jet': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'l1t-l1t': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'rpc-feb': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'rpc-rpc': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'tau-tau': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'csc-ddus': {'EMPTY': 0, 'NOTSET': 82, 'causes': ['UNDEF'], 'comments': []}, 'ecal-ebm': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'ecal-ebp': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'ecal-eem': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'ecal-eep': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'ecal-esm': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'ecal-esp': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'ecal-tpg': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'hcal-ho0': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'l1t-muon': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'rpc-elog': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': [' http://cmsonline.cern.ch/cms-elog/998994']}, 'btag-btag': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'csc-csctf': {'EMPTY': 0, 'NOTSET': 82, 'causes': ['UNDEF'], 'comments': []}, 'ecal-ecal': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'hcal-hbls': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'hcal-hcal': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'hcal-hels': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'hcal-hfls': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'hcal-ho12': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'hlt-bjets': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'hlt-muons': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'l1t-l1tmu': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'lumi-lumi': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'muon-muon': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'rpc-noise': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': [' https://cmswbm.web.cern.ch/cmswbm/cmsdb/servlet/RPCSummary?Run=299327&TopMenu=RPCRunSummary2&TopMenu2=ZeroPage&SubMenu=1']}, 'csc-strips': {'EMPTY': 0, 'NOTSET': 82, 'causes': ['UNDEF'], 'comments': []}, 'csc-timing': {'EMPTY': 0, 'NOTSET': 82, 'causes': ['UNDEF'], 'comments': []}, 'dc-lowlumi': {'BAD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'ecal-laser': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'ecal-noise': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'hcal-ho0ls': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'hlt-global': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'hlt-jetmet': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'ctpps-ctpps': {'BAD': 82, 'EMPTY': 0, 'causes': [], 'comments': []}, 'ecal-timing': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'hcal-ho12ls': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'hlt-photons': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'l1t-e_gamma': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'l1t-hf_tech': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'l1t-l1tcalo': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'l1t-muon_dt': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'csc-gasgains': {'EMPTY': 0, 'NOTSET': 82, 'causes': ['UNDEF'], 'comments': []}, 'csc-segments': {'EMPTY': 0, 'NOTSET': 82, 'causes': ['UNDEF'], 'comments': []}, 'l1t-bcs_tech': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'l1t-hf_rings': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'l1t-muon_csc': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'l1t-muon_rpc': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'l1t-rpc_tech': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'l1t-software': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'castor-castor': {'EMPTY': 0, 'causes': ['UNDEF'], 'EXCLUDED': 82, 'comments': []}, 'csc-integrity': {'EMPTY': 0, 'NOTSET': 82, 'causes': ['UNDEF'], 'comments': []}, 'csc-occupancy': {'EMPTY': 0, 'NOTSET': 82, 'causes': ['UNDEF'], 'comments': []}, 'csc-pedestals': {'EMPTY': 0, 'NOTSET': 82, 'causes': ['UNDEF'], 'comments': []}, 'csc-triggerpe': {'EMPTY': 0, 'NOTSET': 82, 'causes': ['UNDEF'], 'comments': []}, 'dt-dt_private': {'BAD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'ecal-analysis': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'egamma-egamma': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'hlt-electrons': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'hlt-technical': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'jetmet-jetmet': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'l1t-bptx_tech': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'tracker-pixel': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'tracker-strip': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'tracker-track': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'csc-efficiency': {'EMPTY': 0, 'NOTSET': 82, 'causes': ['UNDEF'], 'comments': []}, 'csc-resolution': {'EMPTY': 0, 'NOTSET': 82, 'causes': ['UNDEF'], 'comments': []}, 'ctpps-rp45_210': {'EMPTY': 0, 'NOTSET': 82, 'causes': [], 'comments': []}, 'ctpps-rp45_220': {'EMPTY': 0, 'NOTSET': 82, 'causes': [], 'comments': []}, 'ctpps-rp45_cyl': {'EMPTY': 0, 'NOTSET': 82, 'causes': [], 'comments': []}, 'ctpps-rp56_210': {'EMPTY': 0, 'NOTSET': 82, 'causes': [], 'comments': []}, 'ctpps-rp56_220': {'EMPTY': 0, 'NOTSET': 82, 'causes': [], 'comments': []}, 'ctpps-rp56_cyl': {'EMPTY': 0, 'NOTSET': 82, 'causes': [], 'comments': []}, 'ecal-preshower': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'csc-csc_private': {'BAD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'ecal-collisions': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'ecal-es_private': {'BAD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'hlt-hlt_private': {'BAD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'l1t-energy_sums': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'rpc-rpc_private': {'BAD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'tau-tau_private': {'EMPTY': 0, 'NOTSET': 82, 'causes': [], 'comments': []}, 'btag-btag_private': {'EMPTY': 0, 'NOTSET': 82, 'causes': [], 'comments': []}, 'ecal-ecal_private': {'BAD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'hcal-hcal_private': {'BAD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'lumi-lumi_private': {'BAD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'muon-muon_private': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'castor-castor_private': {'EMPTY': 0, 'NOTSET': 82, 'causes': [], 'comments': []}, 'egamma-egamma_private': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'jetmet-jetmet_private': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'tracker-pixel_private': {'GOOD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'tracker-strip_private': {'BAD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}, 'tracker-track_private': {'BAD': 82, 'EMPTY': 0, 'causes': ['UNDEF'], 'comments': []}}, 'dataset': '/ReReco/Run2017B_UL2019/DQM', 'runreconstruction__run__run_number': 299327, 'runreconstruction__run__run_type': 'collisions', 'runreconstruction__reconstruction': 'rerecoul', 'pixel': 'Good', 'strip': 'Good', 'tracking': 'Good'}] == ret


